2024-02-27 13:31:07,090 INFO    MainThread:1218551 [wandb_setup.py:_flush():68] Configure stats pid to 1218551
2024-02-27 13:31:07,090 INFO    MainThread:1218551 [wandb_setup.py:_flush():68] Loading settings from /home/zhefanx/.config/wandb/settings
2024-02-27 13:31:07,090 INFO    MainThread:1218551 [wandb_setup.py:_flush():68] Loading settings from /home/zhefanx/Desktop/depth_estimation/Depth-Anything/metric_depth/wandb/settings
2024-02-27 13:31:07,090 INFO    MainThread:1218551 [wandb_setup.py:_flush():68] Loading settings from environment variables: {'start_method': 'thread', '_require_service': 'True'}
2024-02-27 13:31:07,090 INFO    MainThread:1218551 [wandb_setup.py:_flush():68] Inferring run settings from compute environment: {'program_relpath': 'metric_depth/train_mono.py', 'program': '/home/zhefanx/Desktop/depth_estimation/Depth-Anything/metric_depth/train_mono.py'}
2024-02-27 13:31:07,090 INFO    MainThread:1218551 [wandb_init.py:_log_setup():478] Logging user logs to ./wandb/run-20240227_133107-2h2ql4l8/logs/debug.log
2024-02-27 13:31:07,090 INFO    MainThread:1218551 [wandb_init.py:_log_setup():479] Logging internal logs to ./wandb/run-20240227_133107-2h2ql4l8/logs/debug-internal.log
2024-02-27 13:31:07,091 INFO    MainThread:1218551 [wandb_init.py:init():518] calling init triggers
2024-02-27 13:31:07,091 INFO    MainThread:1218551 [wandb_init.py:init():521] wandb.init called with sweep_config: {}
config: {'dataset': 'nyu', 'avoid_boundary': False, 'min_depth': 0.001, 'max_depth': 10, 'data_path': './data/nyu/sync', 'gt_path': './data/nyu/sync', 'filenames_file': './train_test_inputs/nyudepthv2_train_files_with_gt.txt', 'input_height': 480, 'input_width': 640, 'data_path_eval': './data/nyu/dataset/nyu_depth_v2/official_splits/test', 'gt_path_eval': './data/nyu/dataset/nyu_depth_v2/official_splits/test', 'filenames_file_eval': './train_test_inputs/nyudepthv2_test_files_with_gt.txt', 'min_depth_eval': 0.001, 'max_depth_eval': 10, 'min_depth_diff': -10, 'max_depth_diff': 10, 'do_random_rotate': True, 'degree': 1.0, 'do_kb_crop': False, 'garg_crop': False, 'eigen_crop': True, 'save_dir': './depth_anything_finetune', 'project': 'MonoDepth3-nyu', 'tags': '', 'notes': '', 'gpu': 0, 'root': '.', 'uid': '3467b9ea2488', 'print_losses': False, 'distributed': True, 'workers': 16, 'clip_grad': 0.1, 'use_shared_dict': False, 'shared_dict': None, 'use_amp': False, 'aug': True, 'random_crop': False, 'random_translate': False, 'translate_prob': 0.2, 'max_translation': 100, 'validate_every': 0.25, 'log_images_every': 0.1, 'prefetch': False, 'name': 'ZoeDepth', 'version_name': 'v1', 'n_bins': 64, 'bin_embedding_dim': 128, 'bin_centers_type': 'softplus', 'n_attractors': [16, 8, 4, 1], 'attractor_alpha': 1000, 'attractor_gamma': 2, 'attractor_kind': 'mean', 'attractor_type': 'inv', 'midas_model_type': 'DPT_BEiT_L_384', 'min_temp': 0.0212, 'max_temp': 50.0, 'output_distribution': 'logbinomial', 'memory_efficient': True, 'inverse_midas': False, 'img_size': [392, 518], 'train_midas': True, 'use_pretrained_midas': True, 'trainer': 'zoedepth', 'epochs': 5, 'bs': 1, 'lr': 0.000161, 'wd': 0.01, 'div_factor': 1, 'final_div_factor': 10000, 'pct_start': 0.7, 'three_phase': False, 'cycle_momentum': True, 'same_lr': False, 'w_si': 1, 'w_domain': 0.2, 'w_reg': 0, 'w_grad': 0, 'midas_lr_factor': 50, 'encoder_lr_factor': 50, 'pos_enc_lr_factor': 50, 'freeze_midas_bn': True, 'pretrained_resource': 'local::./depth_anything_finetune/ZoeDepthv1_27-Feb_12-54-b75c4fe75f13_latest.pt', 'model': 'zoedepth', 'batch_size': 1, 'mode': 'train', 'world_size': 1, 'rank': 0, 'dist_url': 'tcp://127.0.0.1:15016', 'dist_backend': 'nccl', 'num_workers': 16, 'ngpus_per_node': 1, 'multigpu': True, 'total_params': '335.79M', 'run_id': '27-Feb_13-31-3467b9ea2488', 'experiment_id': 'ZoeDepthv1_27-Feb_13-31-3467b9ea2488'}
2024-02-27 13:31:07,091 INFO    MainThread:1218551 [wandb_init.py:init():571] starting backend
2024-02-27 13:31:07,091 INFO    MainThread:1218551 [wandb_init.py:init():575] setting up manager
2024-02-27 13:31:07,094 INFO    MainThread:1218551 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: fork
2024-02-27 13:31:07,097 INFO    MainThread:1218551 [wandb_init.py:init():582] backend started and connected
2024-02-27 13:31:07,109 INFO    MainThread:1218551 [wandb_init.py:init():670] updated telemetry
2024-02-27 13:31:07,178 INFO    MainThread:1218551 [wandb_init.py:init():710] communicating run to backend with 60.0 second timeout
2024-02-27 13:31:07,473 INFO    MainThread:1218551 [wandb_run.py:_on_init():2121] communicating current version
2024-02-27 13:31:07,557 INFO    MainThread:1218551 [wandb_run.py:_on_init():2125] got version response upgrade_message: "wandb version 0.16.3 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-02-27 13:31:07,557 INFO    MainThread:1218551 [wandb_init.py:init():758] starting run threads in backend
2024-02-27 13:31:08,250 INFO    MainThread:1218551 [wandb_run.py:_console_start():2101] atexit reg
2024-02-27 13:31:08,250 INFO    MainThread:1218551 [wandb_run.py:_redirect():1959] redirect: SettingsConsole.WRAP_RAW
2024-02-27 13:31:08,251 INFO    MainThread:1218551 [wandb_run.py:_redirect():2024] Wrapping output streams.
2024-02-27 13:31:08,251 INFO    MainThread:1218551 [wandb_run.py:_redirect():2046] Redirects installed.
2024-02-27 13:31:08,251 INFO    MainThread:1218551 [wandb_init.py:init():798] run started, returning control to user process
